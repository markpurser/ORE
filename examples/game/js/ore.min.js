/**
 * @license
 * ore.min.js - v0.0.1
 *
 * Licensed under the MIT License.
 * http://github.com/markpurser/ORE/LICENSE
*/

this.ORE=this.ORE||{},function(){function e(e,u){this._pageWidth=e,this._pageHeight=u,this.initialise(),console.log("Hello from Buffer constructor")}var u=e.prototype;e._bufferWidth=6,e._numPages=e._bufferWidth*e._bufferWidth,u.initialise=function(){this.makeGridGraph(),console.log("Hello from Buffer::initialise")},u.makeGridGraph=function(){var u=new Queue;this._buffer=[];for(var i=0;i<e._numPages;i++){var r={id:"page-"+i,data:[],l:null,r:null,u:null,d:null};this._buffer.push(r),u.enqueue(r)}this.makeAdjacencyList(u)},u.makeAdjacencyList=function(u){for(var i=new Queue,r=0;r<e._bufferWidth;r++)i.enqueue(u.dequeue());for(r=0;r<e._bufferWidth-1;r++){var f=new Queue;i.enqueue(i.peek());for(var n=0;n<e._bufferWidth;n++){var t=i.dequeue();console.log(t),t.r=i.peek(),t.r.l=t,t.d=u.dequeue(),t.d.u=t,f.enqueue(t.d)}i=f}},ORE.Buffer=e}();
this.ORE=this.ORE||{},function(){ORE.init=function(e){this._renderingCanvas=e.canvas;var r=e.tileWidthPx,t=e.tileHeightPx,n=e.mapViewWidth,i=e.mapViewHeight;this._buffer=new ORE.Buffer(n,i);var a=PIXI.loader;a.add("tilesheet",e.tilesheetImage),a.load(function(a,o){function f(){e.displayStats&&ORE.updateStats(d);for(var r=0;i>r;r++)for(var t=I+(r+m)*h,a=0;n>a;a++){var o=E[t++];w[a+r*n].texture=g[o]}requestAnimationFrame(f),ORE._renderer.render(p)}var d={fpsText:new PIXI.Text("",{font:"24px Arial",fill:16715792}),fpsTimer:0,currentFrameCount:0},s=o.tilesheet.texture.width/r,u=o.tilesheet.texture.height/t,h=6*n,c=6*i,l=new PIXI.Container,p=new PIXI.Container;p.addChild(l),p.addChild(d.fpsText);var I=16,m=16,v={clearBeforeRender:!0,preserveDrawingBuffer:!1,resolution:1,view:this._renderingCanvas};ORE._renderer=PIXI.autoDetectRenderer(0,0,v),ORE._renderer.backgroundColor=6750105,document.body.appendChild(ORE._renderer.view);var g=[];_.range(s).forEach(function(e){_.range(u).forEach(function(n){var i=new PIXI.Rectangle(e*r,n*t,r,t);g[e+n*s]=new PIXI.Texture(o.tilesheet.texture,i)})});var E=[];_.range(h).forEach(function(e){_.range(c).forEach(function(r){E[e+r*h]=_.random(63)})});var w=[];_.range(n).forEach(function(e){_.range(i).forEach(function(i){var a=new PIXI.Sprite(g[0]);a.position.x=e*r,a.position.y=i*t,a.width=r,a.height=t,w[e+i*n]=a,l.addChild(a)})}),requestAnimationFrame(f)})},ORE.updateStats=function(e){if(e.currentFrameCount++,0===e.fpsTimer)e.fpsTimer=(new Date).getTime();else if((new Date).getTime()-e.fpsTimer>1e3){var r="Canvas";ORE._renderer instanceof PIXI.WebGLRenderer&&(r="WebGL"),e.fpsText.text="fps: "+e.currentFrameCount+"\npixi: "+PIXI.VERSION+"\nRenderer: "+r,e.fpsTimer=(new Date).getTime(),e.currentFrameCount=0}}}();